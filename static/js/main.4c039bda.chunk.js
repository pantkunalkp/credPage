(this.webpackJsonptred_cred=this.webpackJsonptred_cred||[]).push([[0],{104:function(e,t,n){},108:function(e,t,n){},113:function(e,t){},114:function(e,t){},123:function(e,t,n){"use strict";n.r(t);var c=n(8),a=n(0),r=n.n(a),o=n(14),i=n.n(o),l=(n(104),n(41)),s=n(35),u=n.n(s),d=n(48),j=n(21),b=n(92),f=(n(108),n(165)),p=n(164),O=n(163),h=n(161),v=n(160),x=n(166),m=n(69),g=n.n(m);function D(e){var t=Math.floor(e-25569),n=new Date(1e3*(86400*t)),c=e-Math.floor(e)+1e-7,a=Math.floor(86400*c);return a-=a%60,new Date(n.getFullYear(),n.getMonth(),n.getDate())}var w=function(e){if(e){var t,n=new Set,c=e.length,a=0,r=new Set,o=new Date,i=(e=e.map((function(e){return{invoiceNo:e["Invoice Numbers"],docNo:e["Document Number"],docDate:D(e["Doc. Date"]),netDueDate:D(e["Net due dt"]),amount:e["Amt in loc.cur."],postingDate:D(e["Pstng Date"]),type:e.Type,vendorCode:e["Vendor Code"],vendorName:e["Vendor name"],vendorType:e["Vendor type"]}})).filter((function(e){return e.docDate<=o&&e.netDueDate>o}))).length;return e=e.filter((function(e){return!n.has(e.invoiceNo)&&(n.add(e.invoiceNo),r.add(e.vendorName),a+=e.amount,e.docDate=e.docDate.toString(),e.netDueDate=e.netDueDate.toString(),e.postingDate=e.postingDate.toString(),!0)})),t=r.size,[e,{"Total Entries":c,"Total Valid Entries":i,"Total Duplicates":i-e.length,"Total Amount":a,"Total Vendors":t}]}return null},y=n(159),S=n(154),N=n(156),k=n(158),C=n(125),I=Object(S.a)({root:{minWidth:150,maxWidth:200},title:{fontSize:14}}),T=function(e){var t=e.title,n=e.value,a=I();return Object(c.jsx)(N.a,{className:a.root,children:Object(c.jsxs)(k.a,{children:[Object(c.jsx)(C.a,{className:a.title,color:"textSecondary",gutterBottom:!0,children:t}),Object(c.jsx)(C.a,{variant:"h5",component:"h2",children:n})]})})},F=n(162),A=function(){return Object(c.jsx)("div",{style:{width:"100vw",height:"100vh",backgroundColor:"#00000063",display:"flex",justifyContent:"center",alignItems:"center",position:"fixed",top:0,left:0,zIndex:99999},children:Object(c.jsx)(y.a,{})})},M=n(34),P=n(88);function B(){var e=Object(P.a)(["\n    mutation AddInvoice($invoice: InvoiceInput!) {\n        addInvoice(invoice: $invoice) {\n            invoiceNo\n        }\n    }\n"]);return B=function(){return e},e}var V=Object(M.gql)(B()),E=r.a.forwardRef((function(e,t){return Object(c.jsx)(x.a,Object(l.a)({direction:"up",ref:t},e))})),R=function(e){var t=e.isOpen,n=e.callback,r=e.file,o=Object(a.useState)(null),i=Object(j.a)(o,2),l=i[0],s=i[1],b=Object(a.useState)(null),x=Object(j.a)(b,2),m=x[0],D=x[1],S=Object(a.useState)(!1),N=Object(j.a)(S,2),k=N[0],C=N[1],I=Object(a.useState)(!1),P=Object(j.a)(I,2),B=P[0],R=P[1],Y=Object(a.useState)(""),_=Object(j.a)(Y,2),z=_[0],q=_[1],G=Object(M.useMutation)(V),J=Object(j.a)(G,1)[0];Object(a.useEffect)((function(){r&&function(){var e=new FileReader;e.onload=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,c,a,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.result,c=g.a.read(n,{type:"binary",bookVBA:!0}),a=c.SheetNames[0],r=c.Sheets[a],o=g.a.utils.sheet_to_json(r),e.next=7,s(o);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.readAsBinaryString(r)}()}),[r]),Object(a.useEffect)((function(){null===m&&(D(w(l)?w(l):null),console.log(m))}),[m,l]);var L=function(){s(null),D(null),n()},U=function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(!0),e.next=3,setTimeout((function(){Promise.all(m[0].map((function(e){return J({variables:{invoice:e}})}))).then((function(e){R(!0),C(!1),console.log(e),q("Great You are Done")})).catch((function(e){q("Some Files Failed to Upload, Please Retry")}))}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.jsxs)(p.a,{open:t,TransitionComponent:E,keepMounted:!0,onClose:L,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(c.jsx)(v.a,{id:"alert-dialog-slide-title",children:"Statistics"}),k?Object(c.jsx)(A,{}):"",Object(c.jsxs)(h.a,{children:[r&&l&&m?Object(c.jsx)(F.a,{container:!0,spacing:2,children:Object.entries(m[1]).map((function(e){return Object(c.jsx)(F.a,{item:!0,children:Object(c.jsx)(T,{title:e[0],value:e[1]})})}))}):Object(c.jsx)(y.a,{}),z?Object(c.jsx)("p",{children:z}):""]}),Object(c.jsxs)(O.a,{children:[Object(c.jsx)(f.a,{onClick:U,variant:"contained",color:"primary",disabled:B,children:B?"Done":"Upload"}),Object(c.jsx)(f.a,{onClick:L,variant:"contained",color:"secondary",children:"Cancel"})]})]})},Y=["xlsx","xlsb","xlsm","xls","csv","wb*","wq*"].map((function(e){return"."+e})).join(",");var _=function(){var e=Object(a.useState)(null),t=Object(j.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!1),i=Object(j.a)(o,2),s=i[0],f=i[1],p=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t[0]){e.next=5;break}return e.next=3,r(t[0]);case 3:return e.next=5,f(!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=Object(b.a)({onDrop:p}),h=O.getRootProps,v=O.getInputProps,x=O.isDragActive;return Object(c.jsxs)("div",{className:"app",children:[Object(c.jsxs)("div",Object(l.a)(Object(l.a)({},h({className:"drop-area"})),{},{children:[Object(c.jsx)("input",Object(l.a)({},v({accept:Y}))),x?Object(c.jsx)("h1",{children:"Great! You can drop the click now"}):Object(c.jsx)("h1",{children:"Drag or Browse Your File!"})]})),Object(c.jsx)(R,{isOpen:s,callback:function(){return f(!1)},file:n})]})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,168)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),c(e),a(e),r(e),o(e)}))},q=new M.ApolloClient({uri:"http://localhost:4000/",cache:new M.InMemoryCache});i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(M.ApolloProvider,{client:q,children:Object(c.jsx)(_,{})})}),document.getElementById("root")),z()},72:function(e,t){}},[[123,1,2]]]);
//# sourceMappingURL=main.4c039bda.chunk.js.map